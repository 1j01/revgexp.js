<html>
<head>
    <script src="utils.js"></script>
    <script src="parser.js"></script>
    <script src="main.js"></script>

    <script src="support/jquery.js"></script>
    <script src="support/jstree.js"></script>
    <script src="support/jstree.ui.js"></script>
    <script src="support/jstree.hotkeys.js"></script>
</head>

<body>

<table width="500px">
    <tr>
        <td>RegExp:</td><td><input id="regexp" style="width:100%" value="(a)|(b)"></input></td>
    </tr>
    <tr>
        <td>Input:</td><td><textarea id="area" rows=5 style="width:100%">a</textarea></td>
    </tr>
    </tr>
        <td></td><td><button onclick="matchIt()" >Match</button></td>
    </tr>
    <tr>
        <td>Result:</td><td><textarea id="result" rows=5 style="width:100%"></textarea></td>
    </tr>
    <tr>
        <td>ParseTree:</td><td><textarea id="parseTree" rows=10 style="width:100%"></textarea></td>
    </tr>
</table>

<div id="selector">
</div>

<script>
$.jstree.THEMES_DIR = 'support/themes/';

$("#selector").jstree({
    "themes" : {
        "theme" : "default",
        "dots" : true,
        "icons" : false
    },
    "plugins" : [ "themes", "html_data","ui", "hotkeys" ]
});

var ref = jQuery.jstree._reference("#selector")

function matchIt() {
    var regexp = document.getElementById('regexp').value;
    var input = document.getElementById('area').value;

    try {
        var res = window.res = exec(input, regexp);
    } catch (exp) {
        alert('Sorry: ' + exp);
        return;
    }


    var resOutput;
    if (res.matches) {
        resOutput = JSON.stringify(res.matches, null, 4);

        ref.create_node(-1, res.trace, 'before');
        ref.open_all();
    } else {
        resOutput = 'null';
    }

    document.getElementById('result').value = resOutput;
    document.getElementById('parseTree').value = JSON.stringify(res.parseTree, null, 4);
}

runTests();



</script>
</html>